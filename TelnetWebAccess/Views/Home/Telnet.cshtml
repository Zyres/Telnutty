@{
    ViewBag.Title = "Telnet";
}
<div class="container">
<h2>Telnet</h2>
    <form role="form">
        <div class="form-group">
            <label for="host" class="control-label">Host</label>
            <input type="text" class="form-control" id="host" placeholder="127.0.0.1">
            <label for="port" class="control-label">Port</label>
            <input type="text" class="form-control" id="port" placeholder="23">
        </div>
        <input class="btn btn-default" type="button" id="connect" value="Connect" />
    </form>
    <div class="top-buffer">
         <textarea rows="20" cols="80" readonly id="terminal" class="form-control terminal"></textarea>
    </div>
</div>
@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.0.3.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the telnet page and send messages.-->
    <script>
        $(function () {
            // Reference the auto-generated proxy for the hub.
            var telnet = $.connection.telnetHub;
            // Create a function that the hub can call back to display messages.
            telnet.client.addText = function (message) {
                // Add the message to the page.
                $('#terminal').append(htmlEncode(message));
                $('#terminal').scrollTop($('#terminal')[0].scrollHeight);
            };
            // Set initial focus to message input box.
            $('#terminal').focus();

            // Start the connection.
            $.connection.hub.start().done(function () {
                $('#terminal').keypress(function (event) {
                    // Call the Send method on the hub.
                    telnet.server.send(event.keyCode);
                });
                $('#connect').click(function () {
                    telnet.server.connect($('#host').val(), $('#port').val());
                });
            });
        });
        // This optional function html-encodes messages for display in the page.
        function htmlEncode(value) {
            var encodedValue = $('<div />').text(value).html();
            return encodedValue;
        }
    </script>
}